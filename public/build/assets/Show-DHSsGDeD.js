import{r as n,j as e,H as D,a as m}from"./app-WseysBlH.js";import{A as T}from"./AuthenticatedLayout-CiU86B-c.js";import{T as p}from"./Toast-ClUC_WF5.js";import"./transition-DU82FH1h.js";function H({auth:g,trainingCenter:f,students:d,date:j,flash:i}){const[c,w]=n.useState(j),[l,o]=n.useState({}),[h,u]=n.useState(!1),[x,y]=n.useState("");new Date(c).toDateString(),new Date().toDateString();const N=new Date().toISOString().split("T")[0],s=c===N;n.useEffect(()=>{const t={};d.forEach(a=>{t[a.id]={status:a.status||"hadir",status:a.status||"hadir",notes:a.notes||""}}),o(t)},[d]);const z=t=>{const a=t.target.value;w(a),m.get(route("coach.attendance.show"),{date:a},{preserveState:!0,preserveScroll:!0})},S=(t,a)=>{s&&o(r=>({...r,[t]:{...r[t],status:a}}))},v=(t,a)=>{s&&o(r=>({...r,[t]:{...r[t],notes:a}}))},k=()=>{u(!0);const t=Object.entries(l).map(([a,r])=>({student_id:parseInt(a),status:r.status,notes:r.notes}));m.post(route("coach.attendance.store"),{date:c,attendances:t},{onFinish:()=>u(!1),preserveScroll:!0})},b=d.filter(t=>t.name.toLowerCase().includes(x.toLowerCase())||t.no_siri.toLowerCase().includes(x.toLowerCase())),C=(t,a)=>{if(!(t===a))return"bg-white border-zinc-200 text-zinc-600 hover:bg-zinc-50";switch(t){case"hadir":return"bg-green-100 border-green-300 text-green-700 font-bold ring-1 ring-green-500";case"tidak_hadir":return"bg-red-100 border-red-300 text-red-700 font-bold ring-1 ring-red-500";case"sakit":return"bg-yellow-100 border-yellow-300 text-yellow-700 font-bold ring-1 ring-yellow-500";case"cuti":return"bg-blue-100 border-blue-300 text-blue-700 font-bold ring-1 ring-blue-500";default:return"bg-white border-zinc-200"}};return e.jsxs(T,{user:g.user,header:e.jsx("h2",{className:"font-bold text-2xl text-zinc-900 leading-tight",children:"Pengurusan Kehadiran"}),children:[e.jsx(D,{title:"Kehadiran"}),i.success&&e.jsx(p,{message:i.success,type:"success"}),i.error&&e.jsx(p,{message:i.error,type:"error"}),e.jsx("div",{className:"py-12 bg-zinc-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-zinc-200 mb-6 flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-zinc-900",children:f.name}),e.jsx("p",{className:"text-zinc-500",children:"Rekod kehadiran pelajar"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{className:"text-sm font-medium text-zinc-700",children:"Tarikh:"}),e.jsx("input",{type:"date",value:c,onChange:z,className:"rounded-lg border-zinc-300 focus:ring-black focus:border-black"})]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("input",{type:"text",placeholder:"Cari nama atau no. keahlian...",value:x,onChange:t=>y(t.target.value),className:"rounded-lg border-zinc-300 w-full md:w-64 focus:ring-black focus:border-black"}),s&&e.jsx("button",{onClick:k,disabled:h,className:"bg-black text-white px-6 py-2 rounded-lg font-bold hover:bg-zinc-800 transition-colors shadow-lg disabled:opacity-50",children:h?"Menyimpan...":"Simpan Kehadiran"}),!s&&e.jsx("span",{className:"bg-zinc-100 text-zinc-500 px-4 py-2 rounded-lg font-medium border border-zinc-200",children:"Mod Lihat Sahaja"})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-xl border border-zinc-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-zinc-200",children:[e.jsx("thead",{className:"bg-zinc-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-zinc-500 uppercase tracking-wider w-1/4",children:"Pelajar"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-bold text-zinc-500 uppercase tracking-wider w-1/2",children:"Status Kehadiran"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-zinc-500 uppercase tracking-wider w-1/4",children:"Catatan"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-zinc-100",children:b.length>0?b.map(t=>e.jsxs("tr",{className:"hover:bg-zinc-50/50",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-bold text-zinc-900",children:t.name}),e.jsx("div",{className:"text-xs text-zinc-500 font-mono",children:t.no_siri})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex justify-center gap-2",children:["hadir","tidak_hadir","sakit","cuti"].map(a=>e.jsxs("button",{onClick:()=>S(t.id,a),disabled:!s,className:`px-3 py-2 rounded-lg text-xs font-medium border transition-all duration-200 ${C(a,l[t.id]?.status)} ${s?"":"cursor-not-allowed opacity-75"}`,children:[a==="hadir"&&"Hadir",a==="tidak_hadir"&&"Tidak Hadir",a==="sakit"&&"Sakit",a==="cuti"&&"Cuti"]},a))})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"text",placeholder:s?"Tambah nota...":"-",value:l[t.id]?.notes||"",onChange:a=>v(t.id,a.target.value),disabled:!s,className:"w-full text-sm rounded-lg border-zinc-200 focus:border-black focus:ring-0 disabled:bg-transparent disabled:border-none disabled:px-0 placeholder-zinc-300"})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"px-6 py-12 text-center text-zinc-400",children:"Tiada pelajar dijumpai."})})})]})})})]})})]})}export{H as default};
