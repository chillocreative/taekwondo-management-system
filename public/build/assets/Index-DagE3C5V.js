import{r as y,u as L,j as e,H as I}from"./app-DzhyEqx4.js";import{A as B}from"./AuthenticatedLayout-DluGT0Cl.js";import"./transition-ACOSn2jj.js";function O({auth:w,children:g,trainingCenters:z}){const[k,j]=y.useState(!1),[x,u]=y.useState(null),{data:l,setData:i,post:D,put:P,delete:F,processing:_,errors:s,reset:N}=L({training_center_id:"",name:"",date_of_birth:"",ic_number:"",belt_level:"white",is_active:!0,from_other_club:!1,tm_number:"",belt_certificate:null}),v=[{value:"white",label:"Putih"},{value:"yellow",label:"Kuning"},{value:"green",label:"Hijau"},{value:"blue",label:"Biru"},{value:"red",label:"Merah"},{value:"black_1",label:"Hitam 1 Dan"},{value:"black_2",label:"Hitam 2 Dan"},{value:"black_3",label:"Hitam 3 Dan"},{value:"black_4",label:"Hitam 4 Dan"},{value:"black_5",label:"Hitam 5 Dan"}],b=(t=null)=>{if(t){u(t);let a=t.date_of_birth||"";if(t.ic_number&&t.ic_number.length>=6){const n=t.ic_number.replace(/\D/g,"");if(n.length>=6){const r=n.substring(0,2),c=n.substring(2,4),d=n.substring(4,6),h=new Date().getFullYear()%100,f=(parseInt(r)>h?"19":"20")+r,o=parseInt(c),m=parseInt(d);o>=1&&o<=12&&m>=1&&m<=31&&(a=`${f}-${c}-${d}`)}}i({training_center_id:t.training_center_id||"",name:t.name,date_of_birth:a,ic_number:t.ic_number||"",belt_level:t.belt_level,is_active:t.is_active,from_other_club:t.from_other_club||!1,tm_number:t.tm_number||"",belt_certificate:null})}else u(null),N();j(!0)},p=()=>{j(!1),u(null),N()},C=t=>{t.preventDefault(),x?P(route("children.update",x.id),{onSuccess:()=>p()}):D(route("children.store"),{onSuccess:()=>p()})},M=t=>{window.location.href=route("children.payment",t)},T=t=>v.find(a=>a.value===t)?.label||t;return e.jsxs(B,{user:w.user,header:e.jsx("h2",{className:"text-xl sm:text-2xl font-semibold leading-tight text-zinc-900",children:"Pengurusan Peserta"}),children:[e.jsx(I,{title:"Nama Peserta"}),e.jsx("div",{className:"py-6 sm:py-12 bg-zinc-50 min-h-screen",children:e.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-zinc-900",children:"Nama Peserta"}),e.jsx("button",{onClick:()=>b(),className:"px-4 py-2 bg-black text-white rounded-lg hover:bg-zinc-800 transition-colors text-sm font-medium w-full sm:w-auto",children:"+ Tambah Peserta"})]}),g.length===0?e.jsxs("div",{className:"bg-white rounded-xl border border-zinc-200 shadow-sm p-12 text-center",children:[e.jsx("p",{className:"text-zinc-500",children:"Tiada peserta didaftarkan lagi."}),e.jsx("button",{onClick:()=>b(),className:"mt-4 px-4 py-2 bg-black text-white rounded-lg hover:bg-zinc-800 transition-colors text-sm font-medium",children:"Tambah Peserta Pertama"})]}):e.jsx("div",{className:"bg-white rounded-xl border border-zinc-200 shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-zinc-200",children:[e.jsx("thead",{className:"bg-zinc-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Nama"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"No. Keahlian"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Pusat Latihan"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"No Kad Pengenalan"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Kategori"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Status Keahlian"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Status Pembayaran"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Tindakan"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-zinc-200",children:g.map(t=>e.jsxs("tr",{className:"hover:bg-zinc-50 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-zinc-900",children:t.name}),e.jsx("div",{className:"text-xs text-zinc-500",children:T(t.belt_level)})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-zinc-900",children:t.student?t.student.no_siri:"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-zinc-900",children:t.training_center?t.training_center.name:"-"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-zinc-900",children:t.ic_number||"-"}),t.date_of_birth&&e.jsx("div",{className:"text-xs text-zinc-500",children:new Date(t.date_of_birth).toLocaleDateString("ms-MY")})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-zinc-900",children:(()=>{if(!t.date_of_birth)return"-";const a=new Date(t.date_of_birth),n=new Date;let r=n.getFullYear()-a.getFullYear();const c=n.getMonth()-a.getMonth();(c<0||c===0&&n.getDate()<a.getDate())&&r--;const d=r<18?"Pelajar":"Dewasa";return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${r<18?"bg-purple-50 text-purple-600 border border-purple-100":"bg-blue-50 text-blue-600 border border-blue-100"}`,children:d})})()})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${t.payment_completed?"bg-emerald-50 text-emerald-600 border border-emerald-100":"bg-zinc-100 text-zinc-600 border border-zinc-200"}`,children:t.payment_completed?"Aktif":"Tidak Aktif"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.payment_completed?e.jsxs("div",{children:[e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-emerald-50 text-emerald-600 border border-emerald-100",children:"Sudah Bayar"}),t.payment_method&&e.jsx("div",{className:"text-xs text-zinc-500 mt-1",children:t.payment_method==="online"?"Online":"Offline"})]}):e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-amber-50 text-amber-600 border border-amber-100",children:"Belum Bayar"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>b(t),className:"px-3 py-1.5 text-xs border border-zinc-300 rounded-lg text-zinc-700 hover:bg-zinc-50 transition-colors",children:"Edit"}),!t.payment_completed&&e.jsx("button",{onClick:()=>M(t.id),className:"px-3 py-1.5 text-xs bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Bayar"})]})})]},t.id))})]})})})]})}),k&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-bold text-zinc-900 mb-4",children:x?"Edit Maklumat Peserta":"Tambah Peserta Baru"}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Nama"}),e.jsx("input",{type:"text",value:l.name,onChange:t=>i("name",t.target.value),className:"w-full px-3 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),s.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Pusat Latihan"}),e.jsxs("select",{value:l.training_center_id,onChange:t=>i("training_center_id",t.target.value),className:"w-full px-3 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Pilih Pusat Latihan"}),z.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),s.training_center_id&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.training_center_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"No. Kad Pengenalan"}),e.jsx("input",{type:"text",value:l.ic_number,onChange:t=>{const a=t.target.value.replace(/\D/g,"").slice(0,12);let n=l.date_of_birth;if(a.length>=6){const r=a.substring(0,2),c=a.substring(2,4),d=a.substring(4,6),h=new Date().getFullYear()%100,f=(parseInt(r)>h?"19":"20")+r,o=parseInt(c),m=parseInt(d);o>=1&&o<=12&&m>=1&&m<=31&&(n=`${f}-${c}-${d}`)}i(r=>({...r,ic_number:a,date_of_birth:n}))},className:"w-full px-3 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Contoh: 120101011234",maxLength:"12",pattern:"\\d{12}"}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"12 digit sahaja, tanpa simbol (Tarikh lahir akan diisi automatik)"}),s.ic_number&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.ic_number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Tarikh Lahir"}),e.jsx("input",{type:"date",value:l.date_of_birth,onChange:t=>i("date_of_birth",t.target.value),className:"w-full px-3 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-base bg-zinc-50",max:new Date().toISOString().split("T")[0],style:{colorScheme:"light"},readOnly:!0}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Diisi automatik dari No. Kad Pengenalan"}),s.date_of_birth&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.date_of_birth})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Kategori"}),e.jsx("input",{type:"text",value:(()=>{if(!l.date_of_birth)return"-";const t=new Date(l.date_of_birth),a=new Date;let n=a.getFullYear()-t.getFullYear();const r=a.getMonth()-t.getMonth();return(r<0||r===0&&a.getDate()<t.getDate())&&n--,n<18?"Pelajar":"Dewasa"})(),className:"w-full px-3 py-2 border border-zinc-300 rounded-lg bg-zinc-50 text-zinc-700 font-medium",readOnly:!0}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Dikira automatik berdasarkan tarikh lahir"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Tahap Tali Pinggang"}),e.jsx("select",{value:l.belt_level,onChange:t=>i("belt_level",t.target.value),className:"w-full px-3 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:v.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),s.belt_level&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.belt_level})]}),e.jsxs("div",{className:"pt-4 border-t border-zinc-200",children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-3",children:"Adakah anda dari kelab lain?"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"from_other_club",checked:l.from_other_club===!0,onChange:()=>i("from_other_club",!0),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-zinc-300"}),e.jsx("span",{className:"ml-2 text-sm text-zinc-700",children:"Ya"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"from_other_club",checked:l.from_other_club===!1,onChange:()=>i("from_other_club",!1),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-zinc-300"}),e.jsx("span",{className:"ml-2 text-sm text-zinc-700",children:"Tidak"})]})]})]}),l.from_other_club&&e.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-blue-200 bg-blue-50 p-4 rounded-r-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Isikan No. TM"}),e.jsx("input",{type:"text",value:l.tm_number,onChange:t=>i("tm_number",t.target.value),className:"w-full px-3 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",placeholder:"Masukkan No. TM"}),s.tm_number&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.tm_number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-2",children:"Upload sijil ujian tali pinggang terkini"}),e.jsx("input",{type:"file",onChange:t=>i("belt_certificate",t.target.files[0]),className:"w-full px-3 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",accept:"image/*,.pdf"}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Format: JPG, PNG, atau PDF (Maks: 2MB)"}),s.belt_certificate&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.belt_certificate})]})]})]}),e.jsxs("div",{className:"mt-6 flex flex-col-reverse sm:flex-row justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:p,className:"px-4 py-2 border border-zinc-300 rounded-lg text-zinc-700 hover:bg-zinc-50 transition-colors",children:"Batal"}),e.jsx("button",{type:"submit",disabled:_,className:"px-4 py-2 bg-black text-white rounded-lg hover:bg-zinc-800 transition-colors disabled:opacity-50",children:_?"Menyimpan...":"Simpan"})]})]})]})})]})}export{O as default};
