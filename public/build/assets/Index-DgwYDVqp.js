import{r as c,a as x,j as e,H as v,L as k}from"./app-C2IhyUkP.js";import{A as w}from"./AuthenticatedLayout-DobwFdSM.js";import{T as y}from"./Toast-OK0oRVtI.js";import"./transition-B275MVl5.js";function T({auth:u,attendances:a,training_centers:p,stats:s,filters:h,flash:d}){const[m,i]=c.useState(null),[o,b]=c.useState(h?.training_center_id||""),[r,l]=c.useState([]);c.useEffect(()=>{o!==(h?.training_center_id||"")&&x.get(route("admin.attendance.index"),{training_center_id:o},{preserveState:!0,replace:!0,preserveScroll:!0})},[o]),c.useEffect(()=>{d?.success?i({message:d.success,type:"success"}):d?.error&&i({message:d.error,type:"error"})},[d]);const g=t=>{t.target.checked?l(a.data.map(n=>n.id)):l([])},j=t=>{r.includes(t)?l(r.filter(n=>n!==t)):l([...r,t])},f=()=>{confirm(`Adakah anda pasti mahu memadam ${r.length} rekod sesi kehadiran ini?`)&&x.post(route("attendance.bulk-destroy-sessions"),{ids:r},{onSuccess:()=>{l([]),i({message:"Rekod berjaya dipadam",type:"success"})}})},N=t=>{confirm("Adakah anda pasti mahu memadam rekod sesi kehadiran ini?")&&x.post(route("attendance.bulk-destroy-sessions"),{ids:[t]},{onSuccess:()=>i({message:"Rekod berjaya dipadam",type:"success"})})};return e.jsxs(w,{user:u.user,header:e.jsx("h2",{className:"font-bold text-2xl text-zinc-900 leading-tight",children:"Pemantauan Kehadiran"}),children:[e.jsx(v,{title:"Pemantauan Kehadiran"}),m&&e.jsx(y,{message:m.message,type:m.type,onClose:()=>i(null)}),e.jsx("div",{className:"py-12 bg-zinc-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-extrabold text-zinc-900 tracking-tight mb-4",children:"Senarai Kehadiran Peserta"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-zinc-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-zinc-900",children:s?.yearly_sessions||0}),e.jsxs("div",{className:"text-[10px] text-zinc-500 uppercase tracking-wider font-bold",children:["Jumlah Kelas Tahun ",s?.current_year]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-zinc-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-zinc-900",children:s?.monthly_sessions||0}),e.jsxs("div",{className:"text-[10px] text-zinc-500 uppercase tracking-wider font-bold",children:["Jumlah Kelas ",s?.current_month_name," ",s?.current_year]})]}),e.jsxs("div",{className:"bg-emerald-50 rounded-xl border border-emerald-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-700",children:s?.hadir||0}),e.jsx("div",{className:"text-[10px] text-emerald-600 uppercase tracking-wider font-bold",children:"Hadir"})]}),e.jsxs("div",{className:"bg-rose-50 rounded-xl border border-rose-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-rose-700",children:s?.tidak_hadir||0}),e.jsx("div",{className:"text-[10px] text-rose-600 uppercase tracking-wider font-bold",children:"Tidak Hadir"})]}),e.jsxs("div",{className:"bg-amber-50 rounded-xl border border-amber-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-700",children:s?.sakit||0}),e.jsx("div",{className:"text-[10px] text-amber-600 uppercase tracking-wider font-bold",children:"Sakit"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-xl border border-purple-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-700",children:s?.cuti||0}),e.jsx("div",{className:"text-[10px] text-purple-600 uppercase tracking-wider font-bold",children:"Cuti"})]})]})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-zinc-200 p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4",children:[e.jsxs("div",{className:"w-full md:w-1/3",children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1 font-bold",children:"Pusat Latihan"}),e.jsxs("select",{value:o,onChange:t=>b(t.target.value),className:"w-full rounded-lg border-zinc-300 focus:border-blue-500 focus:ring-blue-500 text-sm",children:[e.jsx("option",{value:"",children:"Semua Pusat Latihan"}),p.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),r.length>0&&e.jsxs("button",{onClick:f,className:"px-6 py-2 bg-rose-600 text-white rounded-lg hover:bg-rose-700 transition-colors text-sm font-bold flex items-center gap-2 h-fit",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Padam Terpilih (",r.length,")"]})]})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-zinc-200 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-zinc-200",children:[e.jsx("thead",{className:"bg-zinc-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left",children:e.jsx("input",{type:"checkbox",onChange:g,checked:r.length===(a?.data?.length||0)&&(a?.data?.length||0)>0,className:"rounded border-zinc-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-zinc-500 uppercase tracking-wider",children:"Tarikh Kehadiran"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-zinc-500 uppercase tracking-wider",children:"Pusat Latihan"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-bold text-zinc-500 uppercase tracking-wider",children:"Status (Hadir / Jumlah)"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-zinc-500 uppercase tracking-wider",children:"Tindakan"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-zinc-100",children:a.data&&a.data.length>0?a.data.map(t=>e.jsxs("tr",{className:"hover:bg-zinc-50/50 transition duration-150",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:r.includes(t.id),onChange:()=>j(t.id),className:"rounded border-zinc-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-zinc-900",children:new Date(t.attendance_date).toLocaleDateString("ms-MY",{day:"numeric",month:"long",year:"numeric"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-zinc-600 uppercase font-medium",children:t.training_center_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold border ${t.present_count===t.total_students?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-amber-50 text-amber-700 border-amber-200"}`,children:t.status_label})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(k,{href:route("admin.attendance.show-sheet",{date:t.attendance_date,training_center_id:t.training_center_id}),className:"text-blue-600 hover:text-blue-900 font-bold flex items-center gap-1",children:"Lihat"}),e.jsx("button",{onClick:()=>N(t.id),className:"text-rose-600 hover:text-rose-900 font-bold",children:"Padam"})]})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-16 text-center text-zinc-400",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-12 h-12 text-zinc-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"font-medium",children:"Tiada rekod kehadiran dijumpai."})]})})})})]})}),a?.links&&a?.links?.length>3&&e.jsx("div",{className:"px-6 py-4 border-t border-zinc-200 bg-zinc-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-zinc-600",children:["Menunjukkan ",a?.from||0," hingga ",a?.to||0," daripada ",a?.total||0," sesi"]}),e.jsx("div",{className:"flex gap-1",children:a?.links?.map((t,n)=>e.jsx("button",{onClick:()=>t.url&&x.get(t.url),disabled:!t.url,className:`px-3 py-1 border rounded text-sm ${t.active?"bg-black text-white border-black":"bg-white text-zinc-700 border-zinc-300 hover:bg-zinc-50"} ${!t.url&&"opacity-50 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:t.label}},n))})]})})]})]})})]})}export{T as default};
