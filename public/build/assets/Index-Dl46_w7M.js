import{r as c,j as e,H as v,a as h}from"./app-D8n6ut8n.js";import{A as y}from"./AuthenticatedLayout-DoCK1mKy.js";import{T as k}from"./Toast-CcsdPcp9.js";import"./transition-DkBGMlAd.js";function _({auth:p,students:r,selectedDate:u,flash:n}){const[m,g]=c.useState(u),[i,x]=c.useState({}),[o,d]=c.useState(null);c.useEffect(()=>{const t={};r.forEach(s=>{s.attendance_status&&(t[s.id]={status:s.attendance_status,notes:s.notes||""})}),x(t)},[r]),c.useEffect(()=>{n?.success?d({message:n.success,type:"success"}):n?.error&&d({message:n.error,type:"error"})},[n]);const j=t=>{g(t),h.get(route("attendance.index"),{date:t},{preserveState:!0,preserveScroll:!0})},b=(t,s)=>{x(a=>({...a,[t]:{...a[t],status:s}}))},f=(t,s)=>{x(a=>({...a,[t]:{...a[t],notes:s}}))},N=()=>{const t=Object.entries(i).filter(([s,a])=>a.status).map(([s,a])=>({student_id:parseInt(s),status:a.status,notes:a.notes||null}));if(t.length===0){d({message:"Sila tandakan kehadiran sekurang-kurangnya seorang peserta.",type:"error"});return}h.post(route("attendance.bulk-mark"),{attendance_date:m,attendances:t})},l={total:r.length,hadir:Object.values(i).filter(t=>t.status==="hadir").length,tidak_hadir:Object.values(i).filter(t=>t.status==="tidak_hadir").length,cuti:Object.values(i).filter(t=>t.status==="cuti").length,sakit:Object.values(i).filter(t=>t.status==="sakit").length};return e.jsxs(y,{user:p.user,header:e.jsx("h2",{className:"text-xl sm:text-2xl font-semibold leading-tight text-zinc-900",children:"Kehadiran Peserta"}),children:[e.jsx(v,{title:"Kehadiran"}),o&&e.jsx(k,{message:o.message,type:o.type,onClose:()=>d(null)}),e.jsx("div",{className:"py-6 sm:py-12 bg-zinc-50 min-h-screen",children:e.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6",children:[e.jsxs("div",{className:"mb-6 bg-white rounded-xl border border-zinc-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-2",children:"Tarikh"}),e.jsx("input",{type:"date",value:m,onChange:t=>j(t.target.value),className:"px-4 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsx("button",{onClick:N,className:"px-6 py-2 bg-black text-white rounded-lg hover:bg-zinc-800 transition-colors text-sm font-medium",children:"Simpan Kehadiran"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-zinc-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-xs text-zinc-600 mb-1",children:"Jumlah"}),e.jsx("p",{className:"text-2xl font-bold text-zinc-900",children:l.total})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-xs text-green-600 mb-1",children:"Hadir"}),e.jsx("p",{className:"text-2xl font-bold text-green-700",children:l.hadir})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-xs text-red-600 mb-1",children:"Tidak Hadir"}),e.jsx("p",{className:"text-2xl font-bold text-red-700",children:l.tidak_hadir})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"Cuti"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:l.cuti})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-xs text-yellow-600 mb-1",children:"Sakit"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-700",children:l.sakit})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-zinc-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-zinc-200",children:[e.jsx("thead",{className:"bg-zinc-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"No. Keahlian"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Nama Peserta"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Kategori"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Catatan"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-zinc-200",children:r.map(t=>e.jsxs("tr",{className:"hover:bg-zinc-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-zinc-900",children:t.no_siri}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-zinc-900",children:t.nama_pelajar}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-zinc-600",children:e.jsx("span",{className:"capitalize",children:t.kategori})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("select",{value:i[t.id]?.status||"",onChange:s=>b(t.id,s.target.value),className:"text-sm border-zinc-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Pilih Status"}),e.jsx("option",{value:"hadir",children:"Hadir"}),e.jsx("option",{value:"tidak_hadir",children:"Tidak Hadir"}),e.jsx("option",{value:"cuti",children:"Cuti"}),e.jsx("option",{value:"sakit",children:"Sakit"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"text",value:i[t.id]?.notes||"",onChange:s=>f(t.id,s.target.value),placeholder:"Catatan (opsional)",className:"w-full text-sm border-zinc-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})})]},t.id))})]})}),r.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-zinc-500",children:"Tiada peserta dijumpai."})})]})]})})]})}export{_ as default};
