import{r as o,j as e,H as g,a as u}from"./app-DzhyEqx4.js";import{A as f}from"./AuthenticatedLayout-DluGT0Cl.js";import{T as N}from"./Toast-DQsC8tZG.js";import"./transition-ACOSn2jj.js";const y=({status:a})=>{const t={hadir:"bg-green-100 text-green-700 border-green-200",tidak_hadir:"bg-red-100 text-red-700 border-red-200",cuti:"bg-blue-100 text-blue-700 border-blue-200",sakit:"bg-yellow-100 text-yellow-700 border-yellow-200"},i={hadir:"Hadir",tidak_hadir:"Tidak Hadir",cuti:"Cuti",sakit:"Sakit"};return e.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium border ${t[a]||"bg-gray-100 text-gray-800"}`,children:i[a]||a})};function C({auth:a,isParent:t,children:i,students:x,selectedDate:m,flash:r}){const[d,c]=o.useState(null);return o.useEffect(()=>{r?.success?c({message:r.success,type:"success"}):r?.error&&c({message:r.error,type:"error"})},[r]),e.jsxs(f,{user:a.user,header:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight text-zinc-900",children:"Kehadiran"}),t&&e.jsx("span",{className:"text-sm text-zinc-500",children:"Rekod Kehadiran Anak"})]}),children:[e.jsx(g,{title:"Kehadiran"}),d&&e.jsx(N,{message:d.message,type:d.type,onClose:()=>c(null)}),e.jsx("div",{className:"py-6 sm:py-12 bg-zinc-50 min-h-screen",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6",children:t?e.jsx(v,{childrenData:i}):e.jsx(w,{students:x,selectedDate:m,setToast:c})})})]})}function v({childrenData:a}){return!a||a.length===0?e.jsx("div",{className:"text-center p-12 bg-white rounded-xl border border-dashed border-zinc-300",children:e.jsx("p",{className:"text-zinc-500",children:"Tiada rekod anak dijumpai."})}):e.jsx("div",{className:"space-y-8",children:a.map(t=>e.jsxs("div",{className:"bg-white rounded-xl border border-zinc-200 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"bg-zinc-50/50 px-6 py-4 border-b border-zinc-100 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold",children:t.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-zinc-900",children:t.name}),e.jsx("p",{className:"text-xs text-zinc-500 font-mono",children:t.no_keahlian})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"px-3 py-1 bg-green-50 rounded-lg border border-green-100",children:[e.jsx("span",{className:"block text-xs text-green-600 font-medium",children:"Hadir"}),e.jsx("span",{className:"block text-lg font-bold text-green-700 leading-none",children:t.stats.present})]}),e.jsxs("div",{className:"px-3 py-1 bg-zinc-50 rounded-lg border border-zinc-100",children:[e.jsx("span",{className:"block text-xs text-zinc-500 font-medium",children:"Total"}),e.jsx("span",{className:"block text-lg font-bold text-zinc-700 leading-none",children:t.stats.total_classes})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-zinc-50 text-zinc-500 font-medium border-b border-zinc-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3",children:"Tarikh"}),e.jsx("th",{className:"px-6 py-3",children:"Status"}),e.jsx("th",{className:"px-6 py-3",children:"Catatan"})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-100",children:t.attendances&&t.attendances.length>0?t.attendances.map(i=>e.jsxs("tr",{className:"hover:bg-zinc-50/50",children:[e.jsx("td",{className:"px-6 py-3 text-zinc-900 font-medium whitespace-nowrap",children:new Date(i.attendance_date).toLocaleDateString("ms-MY",{weekday:"short",day:"numeric",month:"short",year:"numeric"})}),e.jsx("td",{className:"px-6 py-3",children:e.jsx(y,{status:i.status})}),e.jsx("td",{className:"px-6 py-3 text-zinc-500 italic",children:i.notes||"-"})]},i.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"px-6 py-8 text-center text-zinc-400",children:"Tiada rekod kehadiran."})})})]})})]},t.id))})}function w({students:a,selectedDate:t,setToast:i}){const[x,m]=o.useState(t),[r,d]=o.useState({});o.useEffect(()=>{const s={};a.forEach(n=>{n.attendance_status&&(s[n.id]={status:n.attendance_status,notes:n.notes||""})}),d(s)},[a]);const c=s=>{m(s),u.get(route("attendance.index"),{date:s},{preserveState:!0,preserveScroll:!0})},p=(s,n)=>{d(l=>({...l,[s]:{...l[s],status:n}}))},j=(s,n)=>{d(l=>({...l,[s]:{...l[s],notes:n}}))},b=()=>{const s=Object.entries(r).filter(([n,l])=>l.status).map(([n,l])=>({student_id:parseInt(n),status:l.status,notes:l.notes||null}));if(s.length===0){i({message:"Sila tandakan data dahulu.",type:"error"});return}u.post(route("attendance.bulk-mark"),{attendance_date:x,attendances:s})},h={total:a.length,hadir:Object.values(r).filter(s=>s.status==="hadir").length,tidak_hadir:Object.values(r).filter(s=>s.status==="tidak_hadir").length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-zinc-200 shadow-sm p-4 flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsx("span",{className:"text-sm font-medium text-zinc-600",children:"Tarikh:"}),e.jsx("input",{type:"date",value:x,onChange:s=>c(s.target.value),className:"px-3 py-2 border border-zinc-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"flex items-center gap-4 w-full sm:w-auto justify-between sm:justify-end",children:[e.jsxs("div",{className:"flex gap-3 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1 text-green-700 font-medium",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"})," Hadir: ",h.hadir]}),e.jsxs("span",{className:"flex items-center gap-1 text-red-700 font-medium",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500"})," Absent: ",h.tidak_hadir]})]}),e.jsx("button",{onClick:b,className:"px-4 py-2 bg-black text-white text-sm font-medium rounded-lg hover:bg-zinc-800 transition-colors",children:"Simpan"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-zinc-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-zinc-50 border-b border-zinc-200 text-zinc-500 font-medium",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 w-24",children:"No."}),e.jsx("th",{className:"px-6 py-3",children:"Peserta"}),e.jsx("th",{className:"px-6 py-3 w-48",children:"Status"}),e.jsx("th",{className:"px-6 py-3",children:"Catatan"})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-100",children:a.map(s=>e.jsxs("tr",{className:"hover:bg-zinc-50/50",children:[e.jsx("td",{className:"px-6 py-3 text-zinc-500 font-mono text-xs",children:s.no_siri}),e.jsxs("td",{className:"px-6 py-3",children:[e.jsx("div",{className:"font-medium text-zinc-900",children:s.nama_pelajar}),e.jsx("div",{className:"text-xs text-zinc-500 capitalize",children:s.kategori})]}),e.jsx("td",{className:"px-6 py-3",children:e.jsxs("select",{value:r[s.id]?.status||"",onChange:n=>p(s.id,n.target.value),className:"w-full px-2 py-1.5 text-sm border-zinc-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"- Pilih -"}),e.jsx("option",{value:"hadir",children:"Hadir"}),e.jsx("option",{value:"tidak_hadir",children:"Tidak Hadir"}),e.jsx("option",{value:"cuti",children:"Cuti"}),e.jsx("option",{value:"sakit",children:"Sakit"})]})}),e.jsx("td",{className:"px-6 py-3",children:e.jsx("input",{type:"text",value:r[s.id]?.notes||"",onChange:n=>j(s.id,n.target.value),placeholder:"...",className:"w-full px-2 py-1.5 text-sm border-zinc-300 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})})]},s.id))})]})}),a.length===0&&e.jsx("div",{className:"p-8 text-center text-zinc-500",children:"Tiada peserta."})]})]})}export{C as default};
