import{r as d,j as a,H as T,L as A,a as B}from"./app-CD4AIxg9.js";import{A as F}from"./AuthenticatedLayout-CGm9lIhP.js";import{T as y,I as p}from"./TextInput-DGnY6oX9.js";import{I as h}from"./InputLabel-ChvZi1EI.js";import{P as D}from"./PrimaryButton-BhxONTrb.js";import"./transition-BSuLwolt.js";const g=["JANUARI 2025","FEBRUARI 2025","MAC 2025","APRIL 2025","MEI 2025","JUN 2025","JULAI 2025","OGOS 2025","SEPTEMBER 2025","OKTOBER 2025","NOVEMBER 2025","DISEMBER 2025"];function Q({auth:k,student:r}){const f=e=>r.payments?.find(t=>t.month===e),_=g.map((e,t)=>{const s=f(e);return s?s.quantity:t<r.status_bayaran?1:0}),E=g.map(e=>{const t=f(e);return t?t.kategori:r.kategori||"kanak-kanak"}),[i,C]=d.useState(_),[o,M]=d.useState(E),[b,j]=d.useState(!1),[x,P]=d.useState({}),[l,S]=d.useState({nama_pelajar:r.nama_pelajar||"",nama_penjaga:r.nama_penjaga||"",alamat:r.alamat||"",no_tel:r.no_tel||""}),c=e=>o[e]==="kanak-kanak"?30:50,N=()=>i.reduce((e,t,s)=>e+t*c(s),0),v=()=>i.filter(e=>e>0).length,w=()=>{const e=o.filter((t,s)=>i[s]>0);if(e.length>0){const t=e.filter(n=>n==="kanak-kanak").length,s=e.filter(n=>n==="dewasa").length;return t>=s?"kanak-kanak":"dewasa"}return r.kategori||"kanak-kanak"},I=(e,t)=>{const s=t.replace(/\D/g,"").slice(0,2),n=[...i];n[e]=parseInt(s)||0,C(n)},R=(e,t)=>{const s=[...o];s[e]=t,M(s)},u=(e,t)=>{S(s=>({...s,[e]:t}))},K=e=>{e.preventDefault(),j(!0);const t=g.map((n,m)=>({month:n,kategori:o[m],quantity:i[m],amount:c(m),total:i[m]*c(m)})),s={nama_pelajar:l.nama_pelajar,nama_penjaga:l.nama_penjaga,alamat:l.alamat,no_tel:l.no_tel,kategori:w(),status_bayaran:v(),payment_details:t};B.put(route("students.update",r.id),s,{onSuccess:()=>{j(!1)},onError:n=>{P(n),j(!1)}})};return a.jsxs(F,{user:k.user,header:a.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Edit Pelajar"}),children:[a.jsx(T,{title:"Edit Pelajar"}),a.jsx("div",{className:"py-12",children:a.jsx("div",{className:"max-w-5xl mx-auto sm:px-6 lg:px-8",children:a.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:a.jsx("div",{className:"p-6",children:a.jsxs("form",{onSubmit:K,children:[a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex justify-between items-start mb-6",children:[a.jsx("div",{children:a.jsx("h2",{className:"text-2xl font-bold text-gray-800 uppercase",children:l.nama_pelajar||"Nama Pelajar"})}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"No Siri:"}),a.jsx("div",{className:"text-xl font-bold",children:r.no_siri})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-4",children:[a.jsxs("div",{children:[a.jsx(h,{htmlFor:"nama_pelajar",value:"Nama Pelajar *"}),a.jsx(y,{id:"nama_pelajar",type:"text",className:"mt-1 block w-full",value:l.nama_pelajar,onChange:e=>u("nama_pelajar",e.target.value.toUpperCase()),required:!0}),a.jsx(p,{message:x.nama_pelajar,className:"mt-2"})]}),a.jsxs("div",{children:[a.jsx(h,{htmlFor:"no_tel",value:"No. Telefon *"}),a.jsx(y,{id:"no_tel",type:"text",inputMode:"numeric",className:"mt-1 block w-full",value:l.no_tel,onChange:e=>u("no_tel",e.target.value.replace(/\D/g,"")),required:!0,placeholder:"Contoh: 0123456789"}),a.jsx(p,{message:x.no_tel,className:"mt-2"})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx(h,{htmlFor:"nama_penjaga",value:"Nama Penjaga *"}),a.jsx(y,{id:"nama_penjaga",type:"text",className:"mt-1 block w-full",value:l.nama_penjaga,onChange:e=>u("nama_penjaga",e.target.value.toUpperCase()),required:!0}),a.jsx(p,{message:x.nama_penjaga,className:"mt-2"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx(h,{htmlFor:"alamat",value:"Alamat *"}),a.jsx("textarea",{id:"alamat",className:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm resize-y",value:l.alamat,onChange:e=>u("alamat",e.target.value),rows:"3",style:{minHeight:"80px"},required:!0}),a.jsx(p,{message:x.alamat,className:"mt-2"})]})]}),a.jsxs("div",{className:"mb-8",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Butiran Pembayaran"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-blue-500",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-white uppercase tracking-wider",children:"Butiran Pembayaran"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-bold text-white uppercase tracking-wider",children:"Kategori"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-white uppercase tracking-wider",children:"Jumlah Bayaran"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-bold text-white uppercase tracking-wider",children:"Kuantiti"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-white uppercase tracking-wider",children:"Total"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map((e,t)=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:e}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:a.jsxs("select",{value:o[t],onChange:s=>R(t,s.target.value),className:"text-sm border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"kanak-kanak",children:"Kanak-kanak"}),a.jsx("option",{value:"dewasa",children:"Dewasa"})]})}),a.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right",children:["RM",c(t).toFixed(2)]}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:a.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:"2",value:i[t]||"",onChange:s=>I(t,s.target.value),className:"w-12 text-center border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:""})}),a.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right font-medium",children:["RM",(i[t]*c(t)).toFixed(2)]})]},t))})]})}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsxs("div",{className:"w-64",children:[a.jsxs("div",{className:"flex justify-between py-2 border-b",children:[a.jsx("span",{className:"font-semibold text-gray-600",children:"SUBTOTAL"}),a.jsxs("span",{className:"font-semibold",children:["RM ",N().toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between py-2",children:[a.jsx("span",{className:"font-bold text-gray-800",children:"TOTAL"}),a.jsxs("span",{className:"font-bold text-gray-800",children:["RM ",N().toFixed(2)]})]})]})})]}),a.jsx("input",{type:"hidden",name:"status_bayaran",value:v()}),a.jsx("input",{type:"hidden",name:"kategori",value:w()}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[a.jsx(A,{href:route("students.index"),className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded transition duration-200",children:"‚Üê Kembali"}),a.jsx(D,{disabled:b,children:b?"Mengemaskini...":"üíæ Kemaskini"})]})]})})})})})]})}export{Q as default};
