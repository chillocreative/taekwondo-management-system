import{r as n,j as e,H as b}from"./app-BjRmwOIE.js";import{A as p}from"./AuthenticatedLayout-CFqIahOs.js";import"./transition-C_LiFp2X.js";function j({students:o,stats:i}){const[t,a]=n.useState("all"),[r,x]=n.useState(null),d=o.filter(s=>t==="verified_paid"?s.verification_status==="VERIFIED_PAID":t==="toyyibpay_paid_no_local"?s.verification_status==="TOYYIBPAY_PAID_BUT_NO_LOCAL_RECORD":t==="local_but_toyyibpay_unpaid"?s.verification_status==="LOCAL_RECORD_BUT_TOYYIBPAY_UNPAID":t==="correctly_unpaid"?s.verification_status==="CORRECTLY_UNPAID":t==="api_errors"?s.verification_status==="API_ERROR":!0),m=s=>{const l={VERIFIED_PAID:{bg:"bg-green-100",text:"text-green-700",label:"âœ… Verified Paid"},TOYYIBPAY_PAID_BUT_NO_LOCAL_RECORD:{bg:"bg-red-100",text:"text-red-700",label:"âš ï¸ ToyyibPay Paid, No Local"},LOCAL_RECORD_BUT_TOYYIBPAY_UNPAID:{bg:"bg-amber-100",text:"text-amber-700",label:"âš ï¸ Local Record, ToyyibPay Unpaid"},CORRECTLY_UNPAID:{bg:"bg-zinc-100",text:"text-zinc-700",label:"â³ Correctly Unpaid"},API_ERROR:{bg:"bg-red-100",text:"text-red-700",label:"âŒ API Error"}}[s]||{bg:"bg-gray-100",text:"text-gray-700",label:s};return e.jsx("span",{className:`px-2 py-1 ${l.bg} ${l.text} rounded-full text-xs font-medium`,children:l.label})};return e.jsxs(p,{children:[e.jsx(b,{title:"ToyyibPay Verification"}),e.jsx("div",{className:"py-6 sm:py-12 bg-zinc-50 min-h-screen",children:e.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-zinc-200 shadow-sm p-6 mb-6",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-zinc-900",children:"ðŸ” ToyyibPay Payment Verification"}),e.jsx("p",{className:"text-zinc-500 mt-1",children:"Cross-check payment status with ToyyibPay API"})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mt-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 cursor-pointer hover:bg-blue-100",onClick:()=>a("all"),children:[e.jsx("p",{className:"text-blue-800 font-medium text-sm",children:"Total Checked"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:i.total_checked})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 cursor-pointer hover:bg-green-100",onClick:()=>a("verified_paid"),children:[e.jsx("p",{className:"text-green-800 font-medium text-sm",children:"âœ… Verified Paid"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:i.verified_paid})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 cursor-pointer hover:bg-red-100",onClick:()=>a("toyyibpay_paid_no_local"),children:[e.jsx("p",{className:"text-red-800 font-medium text-sm text-xs",children:"âš ï¸ TP Paid, No Local"}),e.jsx("p",{className:"text-2xl font-bold text-red-900",children:i.toyyibpay_paid_no_local})]}),e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 cursor-pointer hover:bg-amber-100",onClick:()=>a("local_but_toyyibpay_unpaid"),children:[e.jsx("p",{className:"text-amber-800 font-medium text-sm text-xs",children:"âš ï¸ Local, TP Unpaid"}),e.jsx("p",{className:"text-2xl font-bold text-amber-900",children:i.local_but_toyyibpay_unpaid})]}),e.jsxs("div",{className:"bg-zinc-50 border border-zinc-200 rounded-lg p-4 cursor-pointer hover:bg-zinc-100",onClick:()=>a("correctly_unpaid"),children:[e.jsx("p",{className:"text-zinc-700 font-medium text-sm",children:"â³ Correctly Unpaid"}),e.jsx("p",{className:"text-2xl font-bold text-zinc-900",children:i.correctly_unpaid})]})]})]}),t!=="all"&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg px-4 py-2 mb-4 flex justify-between items-center",children:[e.jsxs("span",{className:"text-blue-800",children:["Menapis: ",e.jsx("strong",{className:"capitalize",children:t.replace(/_/g," ")})," (",d.length," rekod)"]}),e.jsx("button",{onClick:()=>a("all"),className:"text-blue-600 hover:text-blue-800 font-medium",children:"Padam Filter âœ•"})]}),e.jsx("div",{className:"bg-white rounded-xl border border-zinc-200 shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-zinc-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 font-bold text-zinc-600",children:"No. Siri"}),e.jsx("th",{className:"text-left p-4 font-bold text-zinc-600",children:"Nama"}),e.jsx("th",{className:"text-left p-4 font-bold text-zinc-600",children:"Bill Code"}),e.jsx("th",{className:"text-center p-4 font-bold text-zinc-600",children:"ToyyibPay Status"}),e.jsx("th",{className:"text-center p-4 font-bold text-zinc-600",children:"Local Records"}),e.jsx("th",{className:"text-center p-4 font-bold text-zinc-600",children:"Verification"}),e.jsx("th",{className:"text-center p-4 font-bold text-zinc-600",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-100",children:d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-12 text-zinc-500",children:"Tiada rekod ditemui"})}):d.map(s=>e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:`hover:bg-zinc-50 ${s.verification_status==="TOYYIBPAY_PAID_BUT_NO_LOCAL_RECORD"?"bg-red-50/50":s.verification_status==="LOCAL_RECORD_BUT_TOYYIBPAY_UNPAID"?"bg-amber-50/50":""}`,children:[e.jsx("td",{className:"p-4 font-medium",children:s.no_siri}),e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-xs text-zinc-500",children:s.parent_name})]}),e.jsx("td",{className:"p-4",children:e.jsx("code",{className:"bg-zinc-100 px-2 py-1 rounded text-xs",children:s.bill_code})}),e.jsx("td",{className:"p-4 text-center",children:s.api_error?e.jsxs("span",{className:"text-xs text-red-600",children:["âŒ ",s.api_error]}):e.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.toyyibpay_paid?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:s.toyyibpay_paid?"âœ… PAID":"âŒ UNPAID"}),s.toyyibpay_amount&&e.jsxs("span",{className:"text-xs font-bold",children:["RM ",s.toyyibpay_amount]}),s.toyyibpay_date&&e.jsx("span",{className:"text-xs text-zinc-500",children:s.toyyibpay_date})]})}),e.jsx("td",{className:"p-4 text-center",children:e.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.has_local_receipt?"bg-green-100 text-green-700":"bg-zinc-100 text-zinc-700"}`,children:s.has_local_receipt?"âœ… Has Receipt":"âŒ No Receipt"}),e.jsxs("span",{className:"text-xs text-zinc-500",children:[s.local_payment_count," payment(s)"]})]})}),e.jsx("td",{className:"p-4 text-center",children:m(s.verification_status)}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("button",{onClick:()=>x(r===s.child_id?null:s.child_id),className:"px-3 py-1 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 text-xs font-medium",children:r===s.child_id?"â–² Tutup":"â–¼ Details"})})]},s.child_id),r===s.child_id&&e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"p-4 bg-zinc-50",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white border border-zinc-200 rounded p-3",children:[e.jsx("h5",{className:"font-bold text-sm mb-2",children:"ðŸ” ToyyibPay Data"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-zinc-500",children:"Bill Code:"})," ",e.jsx("code",{className:"ml-2",children:s.bill_code})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-zinc-500",children:"Status:"})," ",e.jsx("span",{className:"ml-2 font-medium",children:s.toyyibpay_status||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-zinc-500",children:"Paid:"})," ",e.jsx("span",{className:"ml-2 font-medium",children:s.toyyibpay_paid?"YES":"NO"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-zinc-500",children:"Amount:"})," ",e.jsxs("span",{className:"ml-2 font-medium",children:["RM ",s.toyyibpay_amount||"0.00"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-zinc-500",children:"Date:"})," ",e.jsx("span",{className:"ml-2 font-medium",children:s.toyyibpay_date||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-white border border-zinc-200 rounded p-3",children:[e.jsx("h5",{className:"font-bold text-sm mb-2",children:"ðŸ’¾ Local Payment Records"}),s.local_payments.length===0?e.jsx("p",{className:"text-xs text-zinc-500",children:"No local payment records"}):e.jsx("div",{className:"space-y-2",children:s.local_payments.map((c,l)=>e.jsxs("div",{className:"bg-zinc-50 p-2 rounded text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"font-medium",children:["#",c.receipt_number]}),e.jsxs("span",{className:"font-bold text-green-600",children:["RM ",c.total]})]}),e.jsx("div",{className:"text-zinc-500 text-[10px]",children:c.payment_date})]},l))})]})]})})})]}))})]})})})]})})]})}export{j as default};
